from typing import List, Dict

from exploit_fs.logical_block import LogicalBlock
from exploit_fs.seq import RunningSequence


class Inode(RunningSequence):
    def __init__(self, st_mode, st_nlink,
                 st_size,
                 st_ctime,
                 st_mtime,
                 st_atime, st_gid=0, st_uid=0):
        self.st_mode = st_mode
        self.st_nlink = st_nlink
        self.st_size = st_size
        self.st_mtime = st_mtime
        self.st_atime = st_atime
        self.st_ctime = st_ctime
        self.st_gid = st_gid
        self.st_uid = st_uid
        self.attrs = {}

        self._logical_blocks: Dict[int, LogicalBlock] = {}

    def items(self):
        return self.__dict__.items()

    def get_all_logical_blocks(self):
        return self._logical_blocks.values()

    def get_logical_block_by_idx(self, idx: int):
        # print(self._logical_blocks.items())
        return self._logical_blocks.get(idx)

    def attach_logical_block(self, logical_block_idx: int, block: LogicalBlock):
        self._logical_blocks[logical_block_idx] = block
