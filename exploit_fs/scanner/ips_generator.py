import ipaddress

from pymongo import MongoClient

from scanner.host_manager import HostManager


class IPGenerator(object):
    def __init__(self):
        self._host_manager = HostManager()

    def gen_records(self, cidr):
        for ip in ipaddress.IPv4Network(cidr):
            ip = str(ip)
            self._host_manager.insert_host_as_pending(ip, 0)

