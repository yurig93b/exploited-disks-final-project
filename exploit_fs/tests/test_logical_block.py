from logical_block import LogicalBlock

from sortedcontainers import SortedDict

from logical_to_physical_block_ref import LogicalToPhysicalBlockRef


def test():
    l = LogicalBlock(physical_block_store=None)
    refs = SortedDict()
    refs[4096] = LogicalToPhysicalBlockRef(logical_block_id=l.lid, end_offset=4096, physical_block_id=-1, physical_block_start_offset=0, physical_block_end_offset=4096)
    l.set_logical_to_physical_refs(refs)

    to_inject =  LogicalToPhysicalBlockRef(logical_block_id=l.lid, end_offset=128, physical_block_id=-1, physical_block_start_offset=0, physical_block_end_offset=8)

    print(l.get_logical_to_physical_refs())
    l.inject_new_refs([to_inject])
    print(l.get_logical_to_physical_refs())


test()