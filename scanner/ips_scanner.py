from pymongo import MongoClient
from scapy.all import * as scapy

class IPScanner(object):
    STATUS_PENDING = ' pending'
    STATUS_DEAD = 'dead'
    STATUS_ALIVE = 'alive'

    FIELD_IP = 'ip'
    FIELD_COUNTRY = 'country'
    FIELD_STATUS = 'status'

    def __init__(self, mongo: MongoClient):
        self._mongo = mongo

    def _listener(self):
        pkts = sniff(filter="icmp", timeout =15,count=15)

        for packet in pkts:
            if  str(packet.getlayer(scapy.ICMP).type) == "8":
                print(packet[IP].src)

    def send_ping_packet(self, ip:str, payload:bytes):
        pass


    def start_processing(self):
        pass